<!-- /*
* Template Name: Blogy
* Template Author: Untree.co
* Template URI: https://untree.co/
* License: https://creativecommons.org/licenses/by/3.0/
*/ -->
<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- ../movieku/template/blogy-1.0.0/ -->
        <!-- META -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Untree.co">
        <link rel="shortcut icon" href="libraries/blogy-1.0.0/favicon.png">
        <meta name="description" content="" />
        <meta name="keywords" content="bootstrap, bootstrap5" />

        <!-- FONTS -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;600;700&display=swap" rel="stylesheet">

        <!-- ICONS -->
        <link rel="stylesheet" href="libraries/blogy-1.0.0/fonts/icomoon/style.css">
        <link rel="stylesheet" href="libraries/blogy-1.0.0/fonts/flaticon/font/flaticon.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

        <!-- BASIC CSS -->
        <link rel="stylesheet" href="libraries/blogy-1.0.0/css/tiny-slider.css">
        <link rel="stylesheet" href="libraries/blogy-1.0.0/css/aos.css">
        <link rel="stylesheet" href="libraries/blogy-1.0.0/css/glightbox.min.css">
        <link rel="stylesheet" href="libraries/blogy-1.0.0/css/style.css">
        <link rel="stylesheet" href="libraries/blogy-1.0.0/css/flatpickr.min.css">

        <!-- CUSTOM CSS -->
        <link rel="stylesheet" href="libraries/Pagination.js/dist/pagination.css">
        <style>
            /* .paginationjs-page {
                height: 200px;
                width: 50%;
                background-color: powderblue;
            } */
        </style>

        <!-- TITLE -->
        <title>MOVILM</title>
    </head>
    <body>
        <!-- NAVIGATION -->
        <div class="site-mobile-menu site-navbar-target">
            <div class="site-mobile-menu-header">
                <div class="site-mobile-menu-close">
                    <span class="icofont-close js-menu-toggle"></span>
                </div>
            </div>
            <div class="site-mobile-menu-body"></div>
        </div>
        <nav class="site-nav">
            <div class="container">
                <div class="menu-bg-wrap">
                    <div class="site-navigation">
                        <div class="row g-0 align-items-center">
                            <div class="col-2">
                                <a href="index.html" class="logo m-0 float-start">Movilm<span class="text-primary">.</span></a>
                            </div>
                            <div class="col-8 text-center">
                                <form action="#" class="search-form d-inline-block d-lg-none">
                                    <input type="text" class="form-control" placeholder="Search...">
                                    <span class="bi-search"></span>
                                </form>
    
                                <ul class="js-clone-nav d-none d-lg-inline-block text-start site-menu mx-auto">
                                    <li class="active"><a href="index.html">Home</a></li>
                                    <li class="has-children">
                                        <a href="pages/movies-list.html">Movie</a>
                                        <ul class="dropdown">
                                            <li><a href="pages/movies-list.html?feature=now-playing">Now Playing</a></li>
                                            <li><a href="pages/movies-list.html?feature=popular">Popular</a></li>
                                            <li><a href="pages/movies-list.html?feature=top-rated">Top Rated</a></li>
                                            <li><a href="pages/movies-list.html?feature=upcoming">Upcoming</a></li>
                                        </ul>
                                    </li>
                                    <li class="has-children">
                                        <a href="pages/tvs-list.html">TV Series</a>
                                        <ul class="dropdown">
                                            <li><a href="pages/tvs-list.html?feature=airing-today">Airing Today</a></li>
                                            <li><a href="pages/tvs-list.html?feature=on-the-air">On The Air</a></li>
                                            <li><a href="pages/tvs-list.html?feature=popular">Popular</a></li>
                                            <li><a href="pages/tvs-list.html?feature=top-rated">Top Rated</a></li>
                                        </ul>
                                    </li>
                                    <li><a href="pages/persons-list.html">Actor & Actress</a></li>
                                    <li><a href="pages/about.html">About</a></li>
                                </ul>
                            </div>
                            <div class="col-2 text-end">
                                <a href="#" class="burger ms-auto float-end site-menu-toggle js-menu-toggle d-inline-block d-lg-none light">
                                    <span></span>
                                </a>
                                <form action="#" class="search-form d-none d-lg-inline-block">
                                    <input type="text" class="form-control" placeholder="Search...">
                                    <span class="bi-search"></span>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- MAIN HOME -->
        <section class="section bg-light">
            <div class="container">
                <div class="row align-items-stretch retro-layout">
                    <div class="col-md-4">

                        <a id="LinkMovieNowPlaying" href="#" class="h-entry mb-30 v-height gradient">
                            <div id="ImageMovieNowPlaying" class="featured-img" style="background-image: url('libraries/blogy-1.0.0/images/img_2_horizontal.jpg');"></div>
                            <div class="text">
                                <span class="date">Now Playing Movie</span>
                                <h2 id="TitleMovieNowPlaying">Lorem ipsum dolor sit amet</h2>
                            </div>
                        </a>

                        <a id="LinkTvAiringToday" href="#" class="h-entry v-height gradient">
                            <div id="ImageTvAiringToday" class="featured-img" style="background-image: url('libraries/blogy-1.0.0/images/img_5_horizontal.jpg');"></div>
                            <div class="text">
                                <span class="date">Airing Today, TV Series</span>
                                <h2 id="TitleTvAiringToday">Lorem ipsum dolor sit amet</h2>
                            </div>
                        </a>

                    </div>
                    <div class="col-md-4">

                        <a id="LinkMovieUpcoming" href="#" class="h-entry img-5 h-100 gradient">
                            <div id="ImageMovieUpcoming" class="featured-img" style="background-image: url('libraries/blogy-1.0.0/images/img_1_vertical.jpg');"></div>
                            <div class="text">
                                <span class="date">Upcoming Movie</span>
                                <h2 id="TitleMovieUpcoming">Lorem ipsum dolor sit amet</h2>
                            </div>
                        </a>

                    </div>
                    <div class="col-md-4">

                        <a id="LinkTvOnTheAir" href="#" class="h-entry mb-30 v-height gradient">
                            <div id="ImageTvOnTheAir" class="featured-img" style="background-image: url('libraries/blogy-1.0.0/images/img_3_horizontal.jpg');"></div>
                            <div class="text">
                                <span class="date">On The Air, TV Series</span>
                                <h2 id="TitleTvOnTheAir">Lorem ipsum dolor sit amet</h2>
                            </div>
                        </a>

                        <a id="LinkPersonPopular" href="#" class="h-entry v-height gradient">
                            <div id="ImagePersonPopular" class="featured-img" style="background-image: url('libraries/blogy-1.0.0/images/img_4_horizontal.jpg');"></div>
                            <div class="text">
                                <span class="date">Popular Actor & Actress</span>
                                <h2 id="TitlePersonPopular">Lorem ipsum dolor sit amet</h2>
                            </div>
                        </a>
                        
                    </div>
                </div>
            </div>
        </section>
        <!-- End retroy layout blog posts -->

        <!-- <h1>This is a Heading</h1> -->
        <!-- <p>This is a paragraph.</p> -->
        <!-- <div id="pagination"></div> -->

        <footer class="site-footer">
            <div class="container">
                    <div class="col-12 text-center">
                    <!-- 
                        **==========
                        NOTE: 
                        Please don't remove this copyright link unless you buy the license here https://untree.co/license/  
                        **==========
                        -->
                        <p>Copyright &copy; <a href="https://dzulfikar68.github.io">dzulfikar68</a> | <script>document.write(new Date().getFullYear());</script>. All Rights Reserved. &mdash; Designed with love by <a href="https://untree.co">Untree.co</a>  Distributed by <a href="https://themewagon.com">ThemeWagon</a> <!-- License information: https://untree.co/license/ -->
                        </p>
                    </div>
            </div> <!-- /.container -->
        </footer> <!-- /.site-footer -->
    
        <!-- Preloader -->
        <div id="overlayer"></div>
        <div class="loader">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>

        <!-- BASIC JS -->
        <script src="libraries/blogy-1.0.0/js/bootstrap.bundle.min.js"></script>
        <script src="libraries/blogy-1.0.0/js/tiny-slider.js"></script>
        <script src="libraries/blogy-1.0.0/js/flatpickr.min.js"></script>
        <script src="libraries/blogy-1.0.0/js/aos.js"></script>
        <script src="libraries/blogy-1.0.0/js/glightbox.min.js"></script>
        <script src="libraries/blogy-1.0.0/js/navbar.js"></script>
        <script src="libraries/blogy-1.0.0/js/counter.js"></script>
        <script src="libraries/blogy-1.0.0/js/custom.js"></script>
        <!-- <script src="js/model.js"></script> -->

        <!-- CUSTOM JS -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        <script src="libraries/Pagination.js/dist/pagination.js"></script>
        <script>
            // $.ajax({
            //     type: 'GET',
            //     url: 'https://lawless-fixture.000webhostapp.com/movilm/get-favorites.php',
            //     success: function(data) {
            //         console.log("data:")
            //         console.log(JSON.parse(data))
            //     },
            //     error: function(error) {
            //         console.log("error:")
            //         console.log(error)
            //     }
            // })

            // set timer
            const startTimeout = function(action, duration) { 
                setTimeout(action, duration) 
            }

            // set random list
            function shuffle(array) {
                var tmp, current, top = array.length;
                if(top) while(--top) {
                    current = Math.floor(Math.random() * (top + 1));
                    tmp = array[current];
                    array[current] = array[top];
                    array[top] = tmp;
                }
                return array;
            }

            // set model
            function getModel() {
                return {
                    timeout: () => { return this },
                    list: [],
                    active: null,
                    index: 0,
                }
            }

            // function change view
            function changeViewOrientation(data, onSetView, duration) {
                data.active = data.list[data.index]
                if (data.active != null) {
                    data.index = data.index + 1
                    onSetView(data)
                    var callback = function() { changeViewOrientation(data, onSetView, duration) }
                    data.timeout = startTimeout(callback, duration)
                } else {
                    clearTimeout(data.timeout)
                    if (data.list.length > 0) {
                        data.active = null
                        data.index = 0
                        changeViewOrientation(data, onSetView, duration)
                    }
                }
            }

            // function fetch api
            function fetchApiList(path, model, setView, duration) {
                $.get("https://api.themoviedb.org/3/" + path + "?api_key=3f7d1c2a7daf6b9f4668c8cf54074ed1", function(data, status) {
                    // console.log("status: " + status)
                    // console.log(data)
                    const { results } = data
                    // console.log(results)
                    model.list = shuffle(results)
                    changeViewOrientation(model, setView, duration)
                })
            }

            // set state
            var movieNowPlaying = getModel()
            var movieUpcoming = getModel()
            var personPopular = getModel()
            var tvAiringToday = getModel()
            var tvOnTheAir = getModel()

            function getImage(path) {
                let imageUrl = ""
                if (path == null) {
                    imageUrl = "images/image_placeholder.jpg"
                } else {
                    imageUrl = "https://image.tmdb.org/t/p/original" + path
                }
                return imageUrl
            }

            // set view
            function setMovieNowPlaying(data) {
                let imageUrl = getImage(data.active.poster_path)
                let textTitle = data.active.original_title
                $('#ImageMovieNowPlaying').css('background-image', 'url(' + imageUrl + ')')
                $('#TitleMovieNowPlaying').text(textTitle)
            }
            function setMovieUpcoming(data) {
                let imageUrl = getImage(data.active.poster_path)
                let textTitle = data.active.original_title
                $('#ImageMovieUpcoming').css('background-image', 'url(' + imageUrl + ')')
                $('#TitleMovieUpcoming').text(textTitle)
            }
            function setPersonPopular(data) {
                let imageUrl = getImage(data.active.profile_path)
                let textTitle = data.active.name
                $('#ImagePersonPopular').css('background-image', 'url(' + imageUrl + ')')
                $('#TitlePersonPopular').text(textTitle)
            }
            function setTvAiringToday(data) {
                let imageUrl = getImage(data.active.poster_path)
                let textTitle = data.active.name
                $('#ImageTvAiringToday').css('background-image', 'url(' + imageUrl + ')')
                $('#TitleTvAiringToday').text(textTitle)
            }
            function setTvOnTheAir(data) {
                let imageUrl = getImage(data.active.poster_path)
                let textTitle = data.active.name
                $('#ImageTvOnTheAir').css('background-image', 'url(' + imageUrl + ')')
                $('#TitleTvOnTheAir').text(textTitle)
            }

            // fetch api
            fetchApiList("person/popular", personPopular, setPersonPopular, 9000)
            fetchApiList("tv/airing_today", tvAiringToday, setTvAiringToday, 8000)
            fetchApiList("tv/on_the_air", tvOnTheAir, setTvOnTheAir, 7000)
            fetchApiList("movie/upcoming", movieUpcoming, setMovieUpcoming, 6000)
            fetchApiList("movie/now_playing", movieNowPlaying, setMovieNowPlaying, 5000)

            // get origin path
            function getOriginPath() {
                let href = window.location.href
                let listPath = href.split("movilm")
                let originPath = listPath[0] + "movilm"
                return originPath
            }

            // get destination page
            function getDestinationPage(path, queries) {
                let origin = getOriginPath() + "/pages/" + path + ".html"
                let url = new URLSearchParams()
                queries.forEach(e => {
                    url.append(e.key, e.value)
                })
                return origin + "?" + url.toString()
            }

            // on click
            $('#LinkMovieNowPlaying').click(function() {
                window.location.href = getDestinationPage("movies-list", [
                    {
                        key: "feature",
                        value: "now-playing"
                    }
                ])
            })
            $('#LinkMovieUpcoming').click(function() {
                window.location.href = getDestinationPage("movies-list", [
                    {
                        key: "feature",
                        value: "upcoming"
                    }
                ])
            })
            $('#LinkPersonPopular').click(function() {
                window.location.href = getDestinationPage("persons-list", [
                    {
                        key: "feature",
                        value: "popular"
                    }
                ])
            })
            $('#LinkTvAiringToday').click(function() {
                window.location.href = getDestinationPage("tvs-list", [
                    {
                        key: "feature",
                        value: "airing-today"
                    }
                ])
            })
            $('#LinkTvOnTheAir').click(function() {
                window.location.href = getDestinationPage("tvs-list", [
                    {
                        key: "feature",
                        value: "on-the-air"
                    }
                ])
            })

            // var url = new URLSearchParams(window.location.search)
            // var x = url.get("q")
            // console.log(x)
            // url.append('active', '1')
            // console.log(url.toString())
// Assuming URL has "?post=1234&action=edit"
// var urlParams = new URLSearchParams(window.location.search);
// console.log(urlParams.has('post')); // true
// console.log(urlParams.get('action')); // "edit"
// console.log(urlParams.getAll('action')); // ["edit"]
// console.log(urlParams.toString()); // "?post=1234&action=edit"
// console.log(urlParams.append('active', '1')); // "?
// post=1234&action=edit&active=1"
        </script>
    </body>
</html>
